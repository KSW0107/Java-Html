<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>promise.html</title>
  <script>
    //서버에 데이터를 요청하는 비동기방식처리 promise 사용 X시에 
    let id = '';
    let name = '';
    setTimeout(function () {
      id = 'user1'

      setTimeout(function () {
        console.log(id);
        name = '사용자1'

        setTimeout(function () {
          console.log(name)
        }, 1000)

      }, 500);

    }, 1000)
    console.log(id);

    //promise 객체 / 정상작동시, 에러시 메소드 2개를 매개변수로
    let promise = new Promise((resolve, reject) => {
      setTimeout(function () {
        resolve('OK');
      }, 1000);
    });

    promise
      .then(function (resolve) { //성공시
        console.log(resolve);
        return resolve.toLowerCase();
      })
      .then(function (result) {
        console.log(result)
      })
      .catch(function (reject) { //실패시
        console.log(reject);
        return reject.text();
      })

    //fetch
    let result = fetch('MOCK_DATA.json');
    let result1 = result.then(function (data) {
      return data.json(); //문자열 : json => object
    });
    result1.then(function(result2){
      console.log(result12)
    })
    .catch(reject => console.log)

    //promise : async, await
    //then 과정을 변수에 담기
    async function getServData() {
      let promise = fetch('MOCK_DATA.json');
      let promise1 = await promise.json();
      console.log(promise1); 
    }

    getServData();
  </script>
</head>

<body>

</body>

</html>